\section{Ground state electronic structure theory} \label{se:est}
Electron correlation is defined in the present work to mean any additional
effect beyond what is included in the ground-state Hartree-Fock (HF)
wave function $\ket{0}$. In ground-state electronic structure theory,
this is typically taken to be an anti-symmetrized, single-determinant wave
function, generally composed of linear combinations of atomic Gaussian
basis functions. In solving the HF equations, the electronic energy
is variationally minimized, under the constraint that the orbital basis
functions of $\ket{0}$ remain orthonormal.\cite{Szabo1996} The resulting
orbitals will be referred to as the canonical molecular orbital (MO) basis.

This section will briefly describe a selection of methods for recovering
the correlation energy which are pertinent to this work. Correlation is
usually included by considering the effects of substituted determinants in
which electrons in ground-state occupied orbitals are substituted (often
referred to as ``excited'') into higher-energy unoccupied (or virtual)
orbitals. These occupied and virtual orbitals are often chosen to be the
canonical MOs of the reference wave function, which in turn are linear
combinations of atomic orbital basis functions. However, as discussed in
[PAPER 3], some schemes apply a different approach -- namely, localization
(and potentially truncation) of the canonical MOs prior to computing the
correlation energy. Therefore, this chapter will focus on \textit{general}
expressions, without assuming canonical or orthogonal orbital spaces
except where mentioned. Einstein summation notation (implied summation
over repeated indices) will be used throughout this chapter, except in
cases where an explicit sum is instructive.

%\subsection{Orbital invariant MP2} \label{ss:mp2}
\subsection{Many-Body Perturbation Theory} \label{ss:mp2}
Correlation energy corrections to the HF energy may be obtained through many-body perturbation theory (MBPT).
%By partitioning the Hamiltonian and expanding the energy and wave function in orders of a perturbation, contributions to the correlation energy are obtained order-by-order. Specifying the Hylleraas partitioning of the normal-ordered electronic Hamiltonian,
We may begin with either the time-dependent or time-independent Schr\"odinger equation --
notation for time-dependence will be suppressed here, 
but the same rules apply as mentioned in Section $\ref{se:res}$.
By partitioning the electronic Hamiltonian $\hat{H}$ into a zeroth-order (HF) term $\hat{H}^{(0)}$ and a perturbation $\hat{H}^{(1)}$,
which is first-order in an undetermined coefficient $\lambda$,
\begin{equation} \label{eq:H}
%    \hat{H}_N = E^{(0)} + \hat{F}_N + \hat{W}_N = \hat{H}^{(0)} + \hat{H}^{(1)} 
    \hat{H} = \hat{H}^{(0)} + \lambda\hat{H}^{(1)} 
\end{equation}
and expanding the electronic energy $E$ and wave function $\ket{\Psi}$ similarly in orders of the perturbation (denoted by superscript), 
\begin{subequations} \label{eq:pert}
    \begin{equation} \label{eq:pert_psi}
        \ket{\Psi} = \sum_{i=0}^{\infty}\lambda^{i}\ket{\Psi^{(i)}}
    \end{equation}
    \begin{equation} \label{eq:pert_e}
        E = \sum_{i=0}^{\infty}\lambda^{i}E^{(i)},
    \end{equation}
\end{subequations}
contributions to the correlation energy are obtained order-by-order. $\ket{\Psi^{(0)}}$ is taken to be $\ket{0}$, 
and $\lambda$ to be one.
Implicit here is the assumption that the perturbation is small relative to the reference -- \textit{i.e.}, 
the correlation energy is several orders of magnitude smaller than the HF energy.
%Specifying the Hylleraas partitioning of the normal-ordered electronic Hamiltonian,
%where $E^{(0)}$ is the Hartree-Fock energy and $\hat{F}_N$ and $\hat{W}_N$ are the normal-ordered Fock 
%operator and fluctuation potential, respectively, the first non-zero contribution is the Hylleraas 
%functional form of the second-order energy,

For a perturbation containing correlation operators, inserting
Eqs.~(\ref{eq:H}) and (\ref{eq:pert}) into the time-independent Schr\"odinger
equation and truncating at the second order in $\lambda$ yields the first
non-zero contribution to the energy:\cite{Szabo1996} \begin{equation}
\label{eq:hyll}
    E^{(2)} = \bra{0}\hat{H}^{(1)}\ket{\Psi^{(1)}}.
\end{equation} Second-order MBPT is equivalent to the minimization
of Eq.~(\ref{eq:hyll}). Using the Hylleraas partitioning of the
Hamiltonian,\cite{Pulay1986b} \begin{subequations}
    \begin{equation}
        \hat{H}^{(0)} = E^{(0)} + \hat{F}
    \end{equation} \begin{equation}
        \hat{H}^{(1)} = \hat{W}
    \end{equation}
\end{subequations} where $\hat{F}$ and $\hat{W}$ are the one- and
two-particle components of $\hat{H}^{(0)}$, respectively, we may solve Eq.~(\ref{eq:hyll}).
This is achieved
through minimization of a residual expression defined by the first-order
wave function equation, 
\begin{equation} \label{eq:mp2_res}
    \hat{W}\ket{0} + \hat{F}\ket{\Psi^{(1)}} = 0.
\end{equation} 

To generate programmable expressions, 
we may choose to represent our first-order perturbed wave function as a linear combination 
of substituted HF determinants with coefficients $t^{ab}_{ij}$ 
\begin{equation}
    \ket{\Psi^{(1)}} = \sum_{ijab}\frac{1}{4}t^{ab}_{ij}\ket{0}.
\end{equation}
Since the Hamiltonian does not connect
$\ket{0}$ to singly-substituted determinants due to the Brillouin
condition,\cite{Szabo1996} it follows that only double substitutions are
present in $\ket{\Psi^{(1)}}$. Projection of Eq.~(\ref{eq:mp2_res}) onto a
basis of doubly-substituted determinants yields programmable expressions
for $t^{ab}_{ij}$.
In the limit of canonical HF orbitals, Eq.~(\ref{eq:hyll}) reduces to the more commonly known second-order M{\o}ller-Plesset perturbation theory (MP2)\cite{Moller1934,Bartlett1974a} expressions,
\begin{subequations}
    \begin{equation} \label{eq:E2}
        %E^{(2)} = \frac{1}{4}t^{ab}_{ij}g^{ab}_{ij}
        E^{(2)} = \frac{1}{4}t^{ab}_{ij}\bra{ij}\ket{ab}
    \end{equation}
    \begin{equation} \label{eq:T2_mp2}
        %t^{ab}_{ij} = - \frac{g^{ab}_{ij}}{\epsilon_a + \epsilon_b - \epsilon_i - \epsilon_j} 
        t^{ab}_{ij} = - \frac{\bra{ij}\ket{ab}}{\epsilon_a + \epsilon_b - \epsilon_i - \epsilon_j} 
    \end{equation}
\end{subequations}
%where $g^{ab}_{ij}$ is the antisymmetryized two-electron integral $\bra{ij}\ket{ab}$ 
where $\bra{ij}\ket{ab}$ is the antisymmetrized two-electron integral between occupied orbitals $\{i,j\}$ and 
virtual orbitals $\{a,b\}$,
and $\epsilon_p$ is the $p$th diagonal element of the Fock matrix. 
This requires only one $\mathcal{O}(N^5)$ step (where $N$ is a measure of system size) in the rotation of the two-electron atomic orbital integrals into the MO basis followed by a one-step energy calculation. 
However, commonplace localizations of the occupied space
\cite{Pulay1986a,Surjan1989,Boughton1993}
require instead the iterative evaluation of 
Eq.~(\ref{eq:mp2_res}). Furthermore, reduced nonorthogonal virtual spaces may be employed in the 
projection basis (as will be explored in [PAPER 3]),\cite{Werner2006} which necessitates the inclusion of additional overlap 
matrices between nonorthogonal orbital spaces in these equations. While this increases the cost by adding 
iterations and additional expressions to evaluate, these additional costs are heavily outweighed by the 
computational savings due to the reduction of $N$ in large systems.

\subsection{Coupled Cluster} \label{ss:cc}
The coupled-cluster family of electronic structure methods
\cite{Sinanoglu1964,Cizek1966,Cizek1969,Crawford2000}
employs an exponentiated cluster operator $\hat{T}$ to include the effects of substituted determinants,
\begin{equation} \label{eq:cc_TISE}
    \hat{H}e^{\hat{T}}\ket{0} = Ee^{\hat{T}}\ket{0}
\end{equation}
with
\begin{subequations}
    \begin{equation} \label{eq:T}
        \hat{T} = \sum_{n=1}^M\hat{T}_n
    \end{equation}
    \begin{equation} \label{eq:T_n}
        \hat{T}_n = \left(\frac{1}{n!}\right)^2 t_{ij\ldots}^{ab\ldots}a_a^{\dagger}a_b^{\dagger}\ldots a_j a_i
    \end{equation}
\end{subequations}
where $M$ is the number of electrons in the system, and $a_p$ and $a_p^\dagger$ are the standard second-quantized 
excitation and de-excitation operators, respectively, for a general orbital $p$.
Rather than perturbative expansion, the cluster operator is expanded in orders of substitutions 
(singles, doubles, \textit{etc}. in Eq.~(\ref{eq:T})), then truncated to a given substitution 
level to produce tractable equations. Additional simplification is achieved by using the 
similarity-transformed Hamiltonian
\begin{equation} \label{eq:Hbar}
    \bar{H} = e^{-\hat{T}}\hat{H}e^{\hat{T}}
\end{equation}
which has the same eigenspectrum as $\hat{H}$, but naturally truncates at four nested commutators in a Campbell-Baker-Hausdorff expansion
\begin{equation} \label{eq:cbh}
    \bar{H} = \hat{H} + [\hat{H}, \hat{T}] + \frac{1}{2!}[[\hat{H}, \hat{T}], \hat{T}] + \frac{1}{3!}[[[\hat{H}, \hat{T}], \hat{T}], \hat{T}] + \frac{1}{4!}[[[[\hat{H}, \hat{T}], \hat{T}], \hat{T}], \hat{T}].
\end{equation}
Projecting Eq.~(\ref{eq:cc_TISE}) on the left by $\bra{0}e^{-\hat{T}}$ yields the coupled cluster 
energy expression and, as in Section \ref{ss:mp2}, expressions for the amplitudes 
$t_{ij\ldots}^{ab\ldots}$ are obtained by projection onto substituted determinants $\bra{\mu}$:
\begin{subequations}
    \begin{equation} \label{eq:cc_E}
        \bra{0}\bar{H}\ket{0} = E_{CC}
    \end{equation}
    \begin{equation} \label{eq:cc_res}
        \bra{\mu}\bar{H}\ket{0} = 0.
    \end{equation}
\end{subequations}
Here Eq.~(\ref{eq:cc_E}) follows from the normalization condition of $\ket{0}$, 
and Eq.~(\ref{eq:cc_res}) follows from the orthogonality condition. 
In the case of localized orbitals, such as those used in [PAPER 3], additional terms 
involving the overlap of nonorthogonal orbitals will appear in the final expressions. 

Untruncated, Eqs.~(\ref{eq:cc_E}) and (\ref{eq:cc_res}) produce exact
solutions to the time-independent Schr\"odinger equation for the
electronic Hamiltonian in a given basis set. Perhaps the most common
truncation of Eq.~(\ref{eq:T}) is to single and double substitutions,
defining the CCSD method. The computational cost of this method scales as
$\mathcal{O}(N^6)$. In terms of MBPT, CCSD may be viewed as correct through
infinite order, but only within the space of single and double substitutions.
A perturbative correction for triples produces the ``gold standard'' in
quantum chemistry, the CCSD(T) method, \cite{Raghavachari1989,Bartlett2005}
which scales as $\mathcal{O}(N^7)$. Aside from these, additional truncation
schemes exist for a variety of purposes. For example, the CCD method
includes only double substitutions, but the complexity of the resulting
equations is far simpler. Another method, CC2,\cite{Christiansen1995}
is tuned for the calculation of molecular response properties, such as
dipoles and polarizabilities. This method truncates the doubles expression
at first order by considering the $\hat{T}_2$ operator as first order. The
full singles expressions from CCSD are retained by considering $\hat{T}_1$
to be first order, and the one- and two-electron terms of the Hamiltonian are
still considered to be zeroth and first order, respectively, as in Section
\ref{ss:mp2}. Solving the resulting iterative amplitude expressions for CC2
scales as $\mathcal{O}(N^5)$ but, unlike the similarly-scaling MP2 method,
includes the effects of singles, which have been shown to be crucial for
computing accurate molecular properties.
\cite{Christiansen1995,Koch1997}
It is important to note that while the studies in [PAPER 2] and [PAPER 3]
utilize CCSD, many other flavors of CC may be used as drop-in replacements,
both in theory and in the implementation of their codes.

\subsection{Reduced Density Matrices} \label{ss:rdm} A general expression
for the ground-state energy of an arbitrary wave function $\ket{\Psi}$
prepared in a basis $\{p,q,r,s\}$ can be written in terms of one- and
two-particle reduced density matrices (1-RDM $D$ and 2-RDM $\Gamma$):
\cite{Harris1992,Trucks1988}
\begin{equation} \label{eq:pdm_e}
    \begin{aligned} E & = \bra{\Psi}\hat{H}\ket{\Psi} \\
      & = D_{pq}h_{p}^{q} + \Gamma_{pqrs}\bra{pq}\ket{rs}
    \end{aligned}
\end{equation} where $h_{p}^{q}$ are the one-electron integrals of the
electronic Hamiltonian, and $D$ and $\Gamma$ are defined according to the
form of $\ket{\Psi}$ and the excitation operators of the second quantized
Hamiltonian: \begin{subequations} \begin{equation} \label{eq:opdm}
    D_{pq} = \bra{\Psi}a_p^{\dagger}a_q\ket{\Psi}
\end{equation} \begin{equation} \label{eq:tpdm}
    \Gamma_{pqrs} = \bra{\Psi}a_p^{\dagger}a_q^{\dagger}a_sa_r\ket{\Psi}.
\end{equation} \end{subequations} 
Clearly, this requires the
left-hand wave function $\bra{\Psi}$. For the electronic Hamiltonian,
which is Hermitian, the left- and right-hand wave functions are identical,
as is the case for MP2. However, this Hermiticity is destroyed for standard
CC methods due to the similarity transformation of the Hamiltonian in
Eq.~(\ref{eq:Hbar}).\cite{Crawford2000} It is therefore necessary to solve for the CC left-hand
wave function, \begin{equation} \label{eq:cc_lwfn}
    \bra{\mathcal{L}} = \bra{\Psi}\hat{\mathcal{L}}
\end{equation} where $\hat{L}$ is a left-hand cluster
operator analogous to Eq.~(\ref{eq:T_n}), with analogous amplitudes
$\lambda_{ij\ldots}^{ab\ldots}$. This additional set of coupled
equations can be solved in the same manner as the right-hand amplitude
expressions. We may then rewrite the coupled cluster energy expression
using Eq.~(\ref{eq:cc_TISE}): \begin{equation} \label{eq:cc_energy_total}
    \bra{\Psi}\hat{\mathcal{L}}\bar{H}\ket{\Psi} = E.
\end{equation}

As will be explored in Section \ref{se:res}, molecular properties may be expressed as 
derivatives of the electronic energy.\cite{Helgaker2012} Given the left- and right-hand wave functions 
and assuming the Hellmann-Feynman theorem\cite{Hellmann1937,Feynman1939} holds 
(and thus $\ket{\Psi}$ carries no dependence 
on external perturbations), the derivative of the energy with respect to an arbitrary 
perturbation operator 
$\hat\Omega$ can be conveniently expressed
\begin{equation} \label{eq:dE}
    \begin{aligned}
    \frac{\partial E}{\partial \hat\Omega} &= \bra{\Psi}\frac{\partial \hat{H}}{\partial \hat\Omega}\ket{\Psi}\\
                                  &= D_{pq}\frac{\partial h_{pq}}{\partial \hat\Omega} + \Gamma_{pqrs}\frac{\partial g_{pqrs}}{\partial \hat\Omega}
    \end{aligned}
\end{equation}
%% NOTE: a lot of notation to clean up here
without further specification of the wave function or Hamiltonian. 
Thus, time-independent first-order properties may be expressed without 
differentiation of the RDMs. This was a driving force behind the study in 
[PAPER 1], and is important for the machine-learning methods discussed in [PAPER 2]. The cases of 
higher-order and time-dependent properties, which are the
focus of [PAPER 1] and [PAPER 3], will be handled in the following section. 
